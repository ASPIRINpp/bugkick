/*!
 * FlashMessage jQuery plug-in
 * 
 * Requires: jQuery
 * @version 1.0 (14-DEC-2011)
 * @author Evgeniy `f0t0n` Naydenov
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(a){function d(a){return this._init(a)}var b={PROGRESS:"progress",MESSAGE:"message",ERROR:"error",SUCCESS:"success",INFORMATION:"information",WARNING:"warning"};var c={SUCCESS:"f0-fm-icon success",INFORMATION:"information",WARNING:"f0-fm-icon warning",ERROR:"f0-fm-icon error"};d.prototype._init=function(c){this.messageType=b.MESSAGE;this.autoHideInterval=3500;this.msg=c||"";this.isError=false;this.iconClass=null;this.hideTimeout=null;this.id="f0FlashMessage_"+(new Date).getTime().toString(10)+"_"+Math.round(Math.random()*1e5);this.containerID=this.id+"_container";this.html='<div id="'+this.containerID+'" class="f0-fm-container"><div id="'+this.id+'" class="f0-fm message">'+this.msg+"</div></div>";this.progressBarCssClass="f0-fm-progress";this.progressBar='<div class="'+this.progressBarCssClass+'"></div>';this.body=a("body");this.body.prepend(this.html);this.container=a("#"+this.containerID);this.element=a("#"+this.id);return this};d.prototype.setIcon=function(a){if(!a)return this;this.removeIcon().element.append('<div id="f0-fm-icon_'+this.id+'" class="f0-fm-icon '+a+'"></div>');this.iconClass=a;return this};d.prototype.removeIcon=function(){if(this.iconClass!==null){this.element.remove("#f0-fm-icon_"+this.id);this.iconClass=null}return this};d.prototype.message=function(a){this.messageType=b.MESSAGE;this.setIsError(false);this._message(a,null).show(true);return this};d.prototype.information=function(a){this.messageType=b.INFORMATION;this.setIsError(false);this._message(a,c.INFORMATION).show(true);return this};d.prototype.success=function(a){this.messageType=b.SUCCESS;this.setIsError(false);this._message(a,c.SUCCESS).show(true);return this};d.prototype.warning=function(a){this.messageType=b.WARNING;this.setIsError(false);this._message(a,c.WARNING).show(true);return this};d.prototype.error=function(a){this.messageType=b.ERROR;this.setIsError(true);this._message(a,c.ERROR).show(true);return this};d.prototype.progress=function(){return this.beginProgress()};d.prototype.beginProgress=function(){this.messageType=b.PROGRESS;this.setIsError(false);this._message(this.progressBar,null).show(false);this.element.data("isProgress",true);return this};d.prototype.endProgress=function(){if(this.element.data("isProgress"))return this._hide();return this};d.prototype._setMessage=function(a){this.msg=a||"";return this};d.prototype._message=function(a,b){this._setMessage(a);this.element.html("").prepend(this.msg);if(b)this.setIcon(b);else this.removeIcon();return this};d.prototype._addErrorClass=function(){if(!this.element.hasClass("error"))this.element.addClass("error");return this};d.prototype._removeErrorClass=function(){if(this.element.hasClass("error"))this.element.removeClass("error");return this};d.prototype.setIsError=function(a){this.isError=a;return this.isError?this._addErrorClass():this._removeErrorClass()};d.prototype._showCallback=function(){var a=this;if(this.autoHide)a.hideTimeout=window.setTimeout(function(){a._hide()},a.autoHideInterval)};d.prototype.show=function(a){this.autoHide=a;var b=this;if(b.hideTimeout){window.clearTimeout(b.hideTimeout);b.hideTimout=null}var c=b.container.height()+"px";if(!b.container.is(":visible")){b.container.css("top","-"+c).show("fast",function(){b.container.animate({top:"0px"},"slow","swing",function(){b._showCallback()})})}else this._showCallback();return this};d.prototype.setAutoHideInterval=function(a){this.autoHideInterval=a||3500;return this};d.prototype._hide=function(){var a=this;var b=a.container.height()+"px";a.container.animate({top:"-"+b},"slow","swing",function(){a.container.hide()});return this};a.__f0__FlashMessage_instance=null;a.flashMessage=function(b){var c=b||"";if(a.__f0__FlashMessage_instance===null)a.__f0__FlashMessage_instance=new d(c);return a.__f0__FlashMessage_instance}})(jQuery)